---
title: "RWorksheet_Bagilidad#4c"
author: "Ace Bagilidad BSIT 2-C"
date: "2023-11-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


1. Use the dataset mpg.
a. Show your solutions on how to import a csv file into the environment.

```{r}

library(readr)

data_mpg <- read.csv("mpg.csv")
data_mpg 

```
b. Which variables from mpg dataset are categorical?

From the data mpg, the categorical data are the following:
1. Transmission(trans)        
2. Model                  
3. Displacement(displ)        
4. Drive Train(drv)                  
5. class

```{r}
data(mpg)
categorical_columns <- data_mpg %>% select_if(is.factor) %>% colnames()

# Print the categorical columns
print(categorical_columns)

```
c. Which are continuous variables?


2. Which manufacturer has the most models in this data set? Which model has the most variations?
Show your answer.
Ans.
The manufacturer with the most model is:  dodge 
The model with the most variations is:  caravan 2wd
```{r}
manufacturer_table <- table(data_mpg$manufacturer)


#getting the most model
maxModel_Manufacturer <- as.character(names(manufacturer_table))[which.max(manufacturer_table)]

cat("The manufacturer with the most model is: ",maxModel_Manufacturer,"\n")

model_table <- table(data_mpg$model)
maxVariation_Model <- as.character(names(model_table))[which.max(model_table)]

cat("The model with the most variations is: ",maxVariation_Model)


```
2a. Group the manufacturers and find the unique models. Show your codes and result.
```{r}
models <- data.frame(Model = model, Manufacturer = manufacturer)
models

unique_models <- unique(models)
print(unique_models)

```



2b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}



```

2. Same dataset will be used. You are going to show the relationship of the modeland the manufacturer.
2a.
```{r}
library(ggplot2)

ggplot(mpg, aes(model,manufacturer)) + geom_point()

```
2b. For you, is it useful? If not, how could you modify the data to make it more informative?



3. Plot the model and the year using ggplot(). Use only the top 20 observations. Write the codes and
its results
```{r}
data_mpg_20 <- head(data_mpg,20)
data_mpg_20
ggplot(data = data_mpg_20, 
       aes(x= year, y=model,
       color = as.factor(model))) + geom_point(alpha = 0.7)+ labs(title = "Relationship between Model, Year, and Manufacturer",
       x = "Year",
       y = "Model",
       color = as.factor(data_mpg_20$model)) 
    

```
4.  Using the pipe (%>%), group the model and get the number of cars per model. Show codes and its result

```{r}
library(dplyr)

#group the number of cars per model

grouped_data <- data_mpg %>% group_by(model) %>% summarise(count = n()) 
grouped_data

```

